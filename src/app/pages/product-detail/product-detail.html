<div class="py-6 product-detail">
    <app-back-button [navigateTo]= "backTo()" class="!m-2">
        Continue shopping
    </app-back-button>

    @if(store.selectedProduct(); as product){
        <div class="flex gap-8 !mb-8">
            <img [src]="product.imageUrl" [alt]="product.name" class="w-[500px] h-[500px] object-cover rounded-lg"
                [style.view-transition-name]=" 'product-name-' + product.id" 
            >
            <div class="flex-1">
                <div class="text-sm rounded-xl bg-gray !px-2 !py-1 w-fit !mb-2">
                    {{product.category }} 
                </div>
                <h1 class="text-2xl font-extrabold !mb-3">
                    {{ product.name}}
                </h1>
                <app-star-rating [rating]="product.rating">
                      {{ product.rating }} ({{ product.reviewCount}} reviews)
                </app-star-rating>
                <p class="text-2xl font-extrabold !mb-3">{{ product.price}}â‚¬</p>
                @if(product.inStock){
                   <div class="flex items-center gap-2 border border-gray-200 rounded-lg !px-3 !py-3 bg-white w-full">
                        <mat-icon class="small">check-circle</mat-icon>
                        <span class="text-xl text-gray-800">In Stock and ready to ship </span>
                    </div> 
                }@else {
                    <div class="flex items-center gap-2 border border-gray-200 rounded-lg !px-3 !py-3 bg-white w-full danger">
                        <mat-icon class="small">warning</mat-icon>
                        <span class="text-sm text-gray-800">This product is currently out of stock. Add it to your wishlist to be ntified when it's available again</span>
                    </div> 
                }
                <p class="font-extrabold !mb-2"> Description</p>
                <p class="text-gray-600 border-b border-gray-200 !pb-4">{{product.description}}</p>
                <div class="flex items-center gap-2 !mb-3 !pt-4">
                    <span class="font-semibold"> Quantity:</span>
                    @if (selectProduct()) {
                        <app-quantity-selector [quantity]="selectProduct()?.quantity!" (quantityUpdated)="store.setItemQuantity(selectProduct()?.product!, $event)"></app-quantity-selector>
                    }@else {
                        <app-quantity-selector [quantity]="quantity" (quantityUpdated)="store.setItemQuantity(product!, $event)"></app-quantity-selector>
                    }
                </div>
                <div class="flex gap-4 mb border-b border-gray-200 !pb-4">
                    <button matButton="filled"
                        class="w-2/3 flex items-center gap-2"
                        (click)="store.addToCart(product, quantity)"
                        [disabled]="!product.inStock"
                    >
                    <mat-icon>shopping_cart</mat-icon>
                    {{product.inStock? 'Add to Cart' : 'Out of Stock' }}
                    </button>
                    <app-toggle-wishlist-button [product]="product" [iconBtn]= "icon" [style.view-transition-name]="'wishlist-button-' + product.id"></app-toggle-wishlist-button>
                    <button matIconButton>
                        <mat-icon>share</mat-icon>
                    </button>

                </div>
            </div>

        </div>

        <app-reviews [product] ="product"></app-reviews>
    }
</div>
